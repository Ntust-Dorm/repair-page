<!DOCTYPE HTML>
<!--
	Spectral by HTML5 UP
	html5up.net | @ajlkn
	Edit by @sheiun
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-124906535-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'UA-124906535-1');
	</script>
	<title data-mlr-text>Repair Page of 2nd Dormitory | Taiwan Tech</title>
	<link rel="shortcut icon" type="image/png" href="favicon.png" />
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<link rel="stylesheet" href="assets/css/form.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>

<body class="landing is-preload">

	<!-- Page Wrapper -->
	<div id="page-wrapper">

		<!-- Header -->
		<header id="header" class="alt">
			<h1><a href="index.html" data-mlr-text>Repair Page of 2nd Dormitory</a></h1>
			<nav id="nav">
				<ul>
					<li class="special">
						<a href="#menu" class="menuToggle"><span data-mlr-text>Menu</span></a>
						<div id="menu">
							<ul>
								<li><a href="https://www.ntust.edu.tw/home.php" target="_blank" class="icon fa-graduation-cap" data-mlr-text>School</a></li>
								<li><a href="https://dss21.ntust.edu.tw/Dorm/" target="_blank" class="icon fa-building" data-mlr-text>Dorm</a></li>
								<li><a href="https://docs.google.com/spreadsheets/u/1/d/1RgAEnYjlW0nh5r2s-H2_OwS2Xx_pHJs4bzXL2RSDwuw/htmlview#gid=532170578"
									 target="_blank" class="icon fa-gift">Package</a></li>
								<li><a href="https://docs.google.com/forms/d/e/1FAIpQLSftf0dDG90ji0DXqs70DNo9gbxaWCZXyXa-IBEvv-5Ayz8n6A/viewform"
									 target="_blank" class="icon fa-gavel">Repair Form</a></li>
							</ul>
							<hr />
							<i class="fa fa-gitlab"> </i><a href="https://gitlab.com/sheiun/ntust-dorm-lang" data-mlr-text>Contributing Localization</a>
							<hr />
							<h4 data-mlr-text>Contributor</h4>
							<span data-mlr-text>Front-End</span><code>SheiUn</code><br />
							<span data-mlr-text>Back-End</span><code>SheiUn</code><br />
							<span>Lang(en)</span><code>SheiUn</code><code>Jessie</code><br />
							<span>Lang(zh-tw)</span><code>SheiUn</code><br />
						</div>
					</li>
				</ul>
			</nav>
		</header>

		<!-- Banner -->
		<section id="banner">
			<div class="inner">
				<label for="language" style="display:inline-block;" data-mlr-text>language:</label>
				<select name="language" class="mb-POCControls_Selector" id="mbPOCControlsLangDrop" style="max-width:150px; display:inline-block;"></select>
				<br /><br />
				<h2 data-mlr-text>Repair Page of 2nd Dormitory</h2>
				<p data-mlr-text>Need a repair for your room or other things?</p>
				<p data-mlr-text>Request repair service conveniently online.</p>
				<br />
				<ul class="actions special">
					<li><a href="#" onclick="document.getElementById('form').style.display='block'" class="button primary" data-mlr-text>Request</a></li>
				</ul>
			</div>
			<a href="#one" class="more scrolly" data-mlr-text>Look More</a>
		</section>

		<!-- One -->
		<section id="one" class="wrapper style1 special">
			<div class="inner">
				<header class="major">
					<h2 data-mlr-text data-mlr-text>Instant Preview</h2>
					<p data-mlr-text>Who is using this websites.</p>
					<table class="align-left">
						<thead>
							<th data-mlr-text>Timestamp</th>
							<th data-mlr-text>Informant</th>
							<th data-mlr-text>Description</th>
							<th data-mlr-text>Status</th>
						</thead>
						<tbody id="records"></tbody>
					</table>
				</header>
				<ul class="icons major">
					<li><span class="icon fa-diamond major style1"><span class="label">Lorem</span></span></li>
					<li><span class="icon fa-heart-o major style2"><span class="label">Ipsum</span></span></li>
					<li><span class="icon fa-code major style3"><span class="label">Dolor</span></span></li>
				</ul>
			</div>
		</section>

		<!-- Two -->
		<section id="two" class="wrapper alt style2">
			<section class="spotlight">
				<div class="image"><img src="images/pic01.png" alt="" /></div>
				<div class="content">
					<h2 data-mlr-text>Notice</h2>
					<p data-mlr-text>If you are in hurry. Please go to dorm center directly.</p>
					<p data-mlr-text>3rd Dormitory 1F</p>
				</div>
			</section>
		</section>

		<!-- Three -->
		<section id="three" class="wrapper style3 special">
			<div class="inner">
				<header class="major">
					<h2 data-mlr-text>Dormitory Cadre</h2>
					<p data-mlr-text>If you have any question of accommodation, contact the residence advisor priority.</p>
				</header>
				<ul class="features">
				</ul>
			</div>
		</section>

		<!-- CTA -->
		<section id="cta" class="wrapper style4">
			<div class="inner">
				<header>
					<p data-mlr-text>If you find the bug, you can click the button to report it.</p>
					<p data-mlr-text>Or you want more information, just go to dorm page.</p>
				</header>
				<ul class="actions stacked">
					<li><a href="mailto:d215039@outlook.com?subject=[Dorm Page][Bug Report]&body=Description: %0D%0A" class="button fit primary"
						 data-mlr-text>Report Bug</a></li>
					<li><a href="https://dss21.ntust.edu.tw/Dorm/" class="button fit" data-mlr-text>Dorm Page</a></li>
				</ul>
			</div>
		</section>

		<!-- Footer -->
		<footer id="footer">
			<ul class="icons">
				<li><a href="https://github.com/sheiun/" class="icon fa-github"><span class="label"></span></a></li>
				<li><a href="mailto:d215039@outlook.com" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
			</ul>
			<ul class="copyright">
				<li>&copy; SheiUn</li>
				<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
			</ul>
		</footer>

	</div>
	<!-- Form -->
	<div id="form">
		<span onclick="document.getElementById('form').style.display='none'" class="close">×</span>
		<div id="form-container" class="animate">
			<h4 data-mlr-text>Request Repair Form</h4>
			<form method="post" action="#">
				<div class="row gtr-uniform">
					<div class="col-6 col-12-xsmall">
						<input type="text" name="name" id="name" value="" placeholder="Name" required/>
					</div>
					<div class="col-6 col-12-xsmall">
						<input type="email" name="email" id="email" value="" placeholder="Email" required/>
					</div>
					<div class="col-4 col-12-xsmall">
						<select name="floor" id="floor" required>
							<option data-mlr-text>-- Floor --</option>
						</select>
					</div>
					<div class="col-4 col-12-xsmall">
						<select name="room" id="room">
							<option data-mlr-text>-- Room --</option>
						</select>
					</div>
					<div class="col-4 col-12-xsmall">
						<select name="bed" id="bed">
							<option data-mlr-text>-- Bed --</option>
						</select>
					</div>
					<div class="col-6 col-12-small">
						<input type="radio" id="civil" name="category" value="Building & Furniture" checked>
						<label for="civil" title="Ex: desk drawer disapper, floor broken" data-mlr-text>Building & Furniture</label>
					</div>
					<div class="col-6 col-12-small">
						<input type="radio" id="plumb" name="category" value="Plumbing & Electrical">
						<label for="plumb" title="Ex: water leaking, bulb broken" data-mlr-text>Plumbing & Electrical</label>
					</div>
					<div class="col-6 col-12-small">
						<input type="radio" id="air" name="category" value="Air Conditioner">
						<label for="air" data-mlr-text>Air Conditioner</label>
					</div>
					<div class="col-6 col-12-small">
						<input type="radio" id="others" name="category" value="Others & Not Sure">
						<label for="others" data-mlr-text>Others & Not Sure</label>
					</div>
					<div class="col-12">
						<textarea name="description" id="description" placeholder="Enter your description&#10;Write in Chinese or English better"
						 rows="3" style="resize: none;" required></textarea>
					</div>
					<div class="col-12">
						<ul class="actions">
							<li><input type="submit" value="Send" class="primary" /></li>
							<li><input type="reset" value="Reset" /></li>
						</ul>
					</div>
				</div>
			</form>
		</div>
	</div>
	<div class="back">
		<div class="lds-ring">
			<div></div>
			<div></div>
			<div></div>
			<div></div>
		</div>
	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script src="assets/js/dorm-cadre.js"></script>
	<script src="https://cdn.rawgit.com/sheiun/ntust-dorm-lang/6aec5ce2/lang-strings.js"></script>
	<script src="assets/js/lang-codes.js"></script>
	<script src="assets/js/lang-drop.js"></script>
	<script>
		function zeroPad(nr, base) {
			var len = (String(base).length - String(nr).length) + 1;
			return len > 0 ? new Array(len).join('0') + nr : nr;
		}
	</script>
	<script>
		/* Initialize floor options */
		var floor = document.getElementById("floor");
		for (var i = 2; i <= 15; i++) {
			var option = document.createElement("option");
			option.value = i;
			option.text = i + "F";
			floor.appendChild(option);
		}
		var room = document.getElementById("room");
		for (var i = 1; i <= 15; i++) {
			var option = document.createElement("option");
			option.value = i;
			option.text = i;
			room.appendChild(option);
		}
		var bed = document.getElementById("bed");
		for (var i = 1; i <= 6; i++) {
			var option = document.createElement("option");
			option.value = i;
			option.text = i;
			bed.appendChild(option);
		}
		/* Form */
		var search_form = document.getElementById('form');
		window.onclick = function (event) {
			if (event.target == search_form) {
				search_form.style.display = "none";
			}
		}
		$("form").on('submit', function (e) {
			e.preventDefault();
			$(".back").show();
			let email = $("#email").val();
			let dorm = '2舍-Dorm.2&';
			let floor = $("#floor").val();
			let room = zeroPad($("#room").val(), 10);
			let bed = $("#bed").val();
			let name = $("#name").val();
			let phone = 'no';
			let repair = encodeURIComponent($("[name='category']:checked").val() + ' / ' + $("#description").val());
			$.ajax({
				type: "POST",
				url: 'https://script.google.com/macros/s/AKfycbwboI_f5gQVhfZPJgd3NQkViqYrX9TbiE538WiDfNgJWt3WYtw/exec',
				data: $("form").serialize(),
				dataType: "json"
			}).done(function (data) {
				if (data.result == 'success') {
					let url = `https://docs.google.com/forms/d/e/1FAIpQLSftf0dDG90ji0DXqs70DNo9gbxaWCZXyXa-IBEvv-5Ayz8n6A/viewform?emailAddress=${email}&entry.1417618539=${dorm}&entry.1314157787=${room}&entry.633414981=${bed}&entry.1856649519=${name}&entry.1502245082=${phone}&entry.359637456=${repair}`;
					$("form").html('record: ' + data.result + '<br>' + `please send it by <a href="${url}" target="_blank" style="color:red;">Google Form</a> NOW!`);
				} else {
					let url = 'https://docs.google.com/forms/d/e/1FAIpQLSftf0dDG90ji0DXqs70DNo9gbxaWCZXyXa-IBEvv-5Ayz8n6A/viewform';
					$("form").html('record: ' + data.result + '<br>' + `please refill the form again or goto <a href="${url}" target="_blank" style="color:red;">Google Form</a> directly.`);
				}
				$(".back").hide();
			});
		});
		/* Table */
		$.getJSON('https://script.google.com/macros/s/AKfycbwboI_f5gQVhfZPJgd3NQkViqYrX9TbiE538WiDfNgJWt3WYtw/exec?type=table', function (data) {
			var count = data[Object.keys(data)[0]].length;
			var row = "<tr>"
			for (var i = count - 1; i >= 0; i--) {
				$.each(data, function (key, value) {
					let cell = `<td>${value[i]}</td>`;
					row += cell;
				});
				row += "</tr>"
			}
			$("#records").html(row);
		});
	</script>

</body>

</html>